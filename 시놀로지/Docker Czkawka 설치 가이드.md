# Synology Docker Czkawka 설치 가이드

## 📋 개요

Czkawka는 중복 파일, 빈 폴더, 대용량 파일을 찾고 삭제하는 무료 파일 관리 프로그램입니다. Docker를 통해 Synology/Xpenology NAS에 설치하여 웹 GUI로 편리하게 사용할 수 있습니다.

## 🎯 주요 기능

- **중복 파일 검색 및 삭제**
- **빈 폴더 정리**
- **대용량 파일 찾기**
- **DSM에서 보이지 않는 숨김 파일도 검색 가능**
- **웹 GUI 제공**

## 🔧 사전 준비

- Docker 패키지 설치 완료
- 설정 파일 저장용 폴더 생성 (`/docker/czkawka/config` 권장)

## 📥 1단계: Docker 이미지 다운로드

### 1-1. Docker 패키지 실행
- DSM → **Docker** 실행

### 1-2. 이미지 추가
- **이미지** 탭 → **추가** → **URL로 추가**
- **URL**: `jlesage/czkawka`
- **태그**: `latest`

### 1-3. 다운로드 완료 대기
- 이미지 다운로드가 완료될 때까지 대기

## ⚙️ 2단계: 컨테이너 생성 및 설정

### 2-1. 컨테이너 생성 시작
- 다운로드된 이미지 선택 → **실행**
- 컨테이너 이름 지정 (예: `czkawka`)

### 2-2. 고급 설정 진행
**고급 설정** 버튼 클릭

#### 환경 변수 설정
다음 환경 변수들을 설정:

| 변수명 | 값 | 설명 |
|--------|-----|------|
| `USER_ID` | `0` | 원활한 파일 검색을 위한 권한 설정 |
| `GROUP_ID` | `0` | 원활한 파일 검색을 위한 권한 설정 |
| `ENABLE_CJK_FONT` | `1` | 한글 폰트 지원 (DSM 7.1 이상) |

⚠️ **DSM 7.2 주의사항**: 
- 값이 입력되지 않은 환경 변수는 **"-" 버튼으로 삭제**
- 삭제하지 않으면 다음 단계로 진행되지 않음

#### 포트 설정
| 컨테이너 포트 | 호스트 포트 | 설명 |
|---------------|-------------|------|
| `5800` | `5800` | Web GUI 접속 포트 |
| `5900` | `5900` | VNC 접속 포트 |

### 2-3. 볼륨 마운트 설정

#### 필수 마운트
| 컨테이너 경로 | 호스트 경로 | 설명 |
|---------------|-------------|------|
| `/config` | `/docker/czkawka/config` | 설정 파일 저장 |
| `/storage` | `/volume1` | 검색할 파일 경로 |

⚠️ **다중 볼륨**: 여러 볼륨을 검색하려면 각각을 별도로 마운트
- 예: `/storage2` → `/volume2`, `/storage3` → `/volume3`

### 2-4. 컨테이너 생성 완료
- 모든 설정 확인 후 **적용** 클릭
- 컨테이너 생성 및 시작

## 🌐 3단계: 웹 GUI 접속

### 3-1. 브라우저 접속
- **URL**: `http://NAS_IP:5800`
- 예: `http://192.168.1.100:5800`

### 3-2. 인터페이스 확인
- Czkawka 웹 GUI가 정상 표시되는지 확인
- 기본적으로 영어 인터페이스로 표시

## 🔤 4단계: 한글 폰트 설정 (옵션)

### 방법 1: 환경 변수 사용 (DSM 7.1 이상)
컨테이너 생성 시 `ENABLE_CJK_FONT=1` 설정으로 자동 설치

⚠️ **방화벽 주의**: 
- NAS 방화벽 활성화 시 폰트 다운로드 실패 가능
- 설치 중 일시적으로 방화벽 비활성화 권장

### 방법 2: 수동 폰트 설치 (모든 버전)

#### 4-1. 폰트 다운로드
- [나눔폰트 다운로드](http://cdn.naver.com/naver/NanumFont/fontfiles/NanumFont_TTF_ALL.zip)
- 다운로드한 ZIP 파일을 `/docker/czkawka/config` 폴더에 업로드

#### 4-2. 컨테이너 터미널 접속
**DSM 7.1 이하:**
- Docker → 컨테이너 → Czkawka 선택 → **세부 정보** → **터미널** 탭

**DSM 7.2 이상:**
- Docker → 컨테이너 → Czkawka 선택 → **작업** → **터미널 열기**

#### 4-3. 폰트 설치 명령어 실행
다음 명령어를 순서대로 실행:

```bash
mkdir /usr/share/fonts/nanumfont
cd /config
unzip NanumFont_TTF_ALL.zip -d /usr/share/fonts/nanumfont
fc-cache -f -v
```

⚠️ **복사/붙여넣기 팁**: 
- DSM 터미널에서 `Ctrl+A` → `Ctrl+V`로 붙여넣기
- 명령어는 한 줄씩 입력 권장

#### 4-4. 컨테이너 재시작
- 컨테이너 **중지** → **시작** (재설정 불필요)
- 웹 GUI 재접속하여 한글 표시 확인

## 🔍 5단계: 사용법

### 5-1. 검색 대상 선택
- **Duplicate Files**: 중복 파일 검색
- **Empty Folders**: 빈 폴더 검색
- **Big Files**: 대용량 파일 검색

### 5-2. 검색 경로 설정
- **Included Directories**: 검색할 폴더 지정
- **Excluded Directories**: 제외할 폴더 지정

### 5-3. 검색 실행 및 결과 처리
- **Start Search** 클릭하여 검색 시작
- 결과 확인 후 필요한 파일 선택하여 삭제

## ⚠️ 주의사항

### DSM 버전별 차이점
- **DSM 7.1**: 기본 설정으로 정상 작동
- **DSM 7.2**: 환경 변수 설정 시 빈 값 삭제 필수

### 권한 설정
- `USER_ID=0`, `GROUP_ID=0` 설정으로 모든 파일 접근 가능
- 숨김 파일 및 시스템 파일도 검색 가능

### 백업 권장
- 대량 삭제 전 중요 파일 백업 필수
- 검색 결과를 신중히 검토 후 삭제

## 🔧 문제 해결

### 컨테이너가 시작되지 않는 경우
- 환경 변수에서 빈 값들을 모두 삭제했는지 확인
- `ENABLE_CJK_FONT` 설정 시 방화벽 비활성화 후 재시도

### 한글이 깨지는 경우
- 방법 2의 수동 폰트 설치 진행
- 컨테이너 재시작 후 확인

### 웹 GUI 접속 불가
- 포트 5800이 다른 서비스와 충돌하지 않는지 확인
- 컨테이너 상태가 **실행 중**인지 확인

---

## 🔗 참고 링크

- [Czkawka GitHub](https://github.com/jlesage/docker-czkawka)
- [Docker Hub](https://hub.docker.com/r/jlesage/czkawka)
- [나눔폰트 다운로드](http://cdn.naver.com/naver/NanumFont/fontfiles/NanumFont_TTF_ALL.zip)

## 💡 추가 팁

- **정기적인 중복 파일 정리**로 저장 공간 최적화
- **대용량 파일 검색**으로 불필요한 파일 식별
- **빈 폴더 정리**로 디렉토리 구조 정리
