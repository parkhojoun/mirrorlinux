# Proxmox VM Locked (Snapshot) 해결 가이드

Proxmox에서 VM이 `locked (snapshot)` 상태로 표시되면서 재부팅이나 기타 작업이 안 되는 경우는 **스냅샷 작업이 중단되거나 실패하면서 잠금이 해제되지 않은 상태**입니다. 이럴 때는 **수동으로 잠금 해제**를 해야 합니다.

다음 단계에 따라 해결할 수 있습니다:

## ✅ 1. 잠금 상태 확인

먼저 VM ID를 확인하고 상태를 봅니다.

```bash
qm list
```

잠금된 VM은 `status` 컬럼에 `locked`로 표시됩니다.

## ✅ 2. 잠금 해제 명령 실행

해당 VM ID가 예를 들어 `101`이라면 아래 명령어로 잠금을 해제할 수 있습니다.

```bash
qm unlock 101
```

## ✅ 3. 다시 시도

잠금을 해제한 뒤 다시 재부팅하거나 시작해보세요.

```bash
qm start 101   # 또는 qm reboot 101
```

## ⚠️ 잠금이 계속된다면?

스냅샷 작업 중 생성된 lock 파일이 시스템에 남아 있을 수 있습니다. 이 경우에는 다음 디렉터리를 확인하세요:

```bash
ls /etc/pve/nodes/<노드이름>/qemu-server/
```

잠금 파일은 `101.conf.lock` 형태로 존재할 수 있습니다. 이를 수동 삭제해서 해결할 수도 있지만 **위험**하므로 반드시 `qm unlock` 명령으로 먼저 시도하고, 최후의 수단으로만 수동 삭제하세요:

```bash
rm /etc/pve/nodes/<노드이름>/qemu-server/101.conf.lock
```

## 💡 참고

- `locked (snapshot)`은 보통 스냅샷 생성 도중 오류로 인해 발생합니다.
- Proxmox의 GUI에서 스냅샷을 수동으로 제거하거나 실패한 스냅샷 작업을 중지할 수도 있습니다.
